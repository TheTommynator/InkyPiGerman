{% extends "plugin.html" %}

{% block content %}
<div class="hw-container" id="hw-container">
  <div
    class="hw-text"
    id="hw-text"
    style="
      text-align: {{ align }};
      color: {{ text_color }};
      font-size: {{ font_size }}px;
      font-family: '{{ font_family }}';
    "
  >{{ text }}</div>
</div>

{% if auto_fit %}
<script>
(function () {
  const container = document.getElementById('hw-container');
  const textEl = document.getElementById('hw-text');

  let size = {{ font_size }};
  const minSize = {{ min_font_size }};

  function fits() {
    return textEl.scrollWidth <= container.clientWidth &&
           textEl.scrollHeight <= container.clientHeight;
  }

  textEl.style.fontSize = size + 'px';

  let guard = 500;
  while (!fits() && size > minSize && guard-- > 0) {
    size -= 2;
    textEl.style.fontSize = size + 'px';
  }
})();
</script>
{% endif %}
{% endblock %}